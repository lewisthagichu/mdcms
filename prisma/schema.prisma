// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model Member {
  id                  String               @id @default(cuid())
  membershipNo        String               @unique
  name                String
  dob                 DateTime
  salutation          String
  sex                 String
  dateJoined          DateTime
  collectionCentre    String
  kraPin              String?
  address             String?
  telephone           String?
  email               String?
  bank                String?
  bankAc              String?
  division            String?
  noOfCows            Int                  @default(0)
  cowsInMilk          Int                  @default(0)
  nationalIdNo        String?
  nhifNo              String?
  nhifAmt             Float                @default(0)
  village             String?
  location            String?
  subLocation         String?
  dateOfLeaving       DateTime?
  creditLimit         Float                @default(0)
  currentCreditUsed   Float                @default(0)
  membershipStatus    String               @default("Active")
  statusDate          DateTime?
  proposers           String?
  comments            String?
  sharesPaid          Int?
  nominee             Nominee?
  payments            Payment[]
  entranceFee         EntranceFee?
  monthlyContribution MonthlyContribution?
  newPlantShares      NewPlantShares?
}

model Nominee {
  id                  Int     @id @default(autoincrement())
  nomineeName         String?
  nomineeIdNo         String?
  nomineeRelationship String?
  nomineeAddress      String?
  nomineeTelNo        String?
  member              Member  @relation(fields: [memberId], references: [id])
  memberId            String  @unique
}

model Payment {
  id        Int     @id @default(autoincrement())
  receiptNo String?
  amount    Float?
  member    Member  @relation(fields: [memberId], references: [id])
  memberId  String
}

model EntranceFee {
  id                       Int    @id @default(autoincrement())
  entranceMonthlyDeduction Float  @default(0)
  entranceAlreadyPaid      Float  @default(0)
  entranceExpected         Float  @default(0)
  member                   Member @relation(fields: [memberId], references: [id])
  memberId                 String @unique
}

model MonthlyContribution {
  id                 Int    @id @default(autoincrement())
  monthlyNormal      Float  @default(0)
  monthlyOverride    Float  @default(0)
  monthlyOverrideBal Float  @default(0)
  member             Member @relation(fields: [memberId], references: [id])
  memberId           String @unique
}

model NewPlantShares {
  id                       Int     @id @default(autoincrement())
  newPlantMonthlyDeduction Float   @default(0)
  newPlantAlreadyPaid      Float   @default(0)
  newPlantExpected         Float   @default(0)
  newPlantCertificateNo    String?
  member                   Member  @relation(fields: [memberId], references: [id])
  memberId                 String  @unique
}
